# 用RTL实现最简单的处理器(NPC)
通过RTL代码来实现一个最简单的处理器

## 最简单的处理器组成
TRM的各个部件:
- PC: 不断加1(指令长度为1)的计数器
- 寄存器: 通用寄存器(general purpose register), 由一组寄存器组成
- 加法器
- 存储器

可以按照处理器工作流程给项目划分模块:
- IFU(Instruction Fetch Unit): 负责根据当前PC从存储器中取出一条指令
- IDU(Instruction Decode Unit): 负责对当前指令进行译码，准备执行阶段使用的数据和控制信号
- EXU(Excution Unit): 负责根据控制信号对数据进行执行操作, 并将执行结果写回寄存器或存储器
- 更新PC: 通过RTL实现时, 这一操作一般与PC寄存器一同实现, 因而无需为此划分一个独立的模块

特别的，对于存储器, 为了方便测试, 我们不通过RTL来实现这个存储器, 而是用C++来实现它. 于是, 我们需要将存储器访问接口的信号拉到顶层, 通过C++代码来访问存储器:

```cpp
while (???) {
  ...
  top->inst = pmem_read(top->pc);
  top->eval();
  ...
}
```

## 在npc中实现第一条指令
### 画出仅支持addi指令的单周期处理器的架构图，如下所示

<img src="../../figs/CamScanner 08-12-2024 14.50.jpg" width="580" />