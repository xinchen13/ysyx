# 完成PA1
南京大学『计算机系统基础』课程实验PA是国内首个也是目前唯一一个模拟器教学实验

- PA承担了系统能力培养的绝大部分任务: 从硬件模拟器, ISA, 运行时环境, 到自制OS, 库函数, 应用程序, 可以深刻认识到程序如何在计算机上运行的每一处细节
- 模拟器是处理器测试验证的一个重要组件: 我们希望大家可以理解模拟器中的每一处细节, 需要的时候可以自行对它进行定制, 而不是把它当作一个和自己没有关系的外部工具

## 阅读PA讲义中的FAQ
- `PA` 是 `Programming Assignment`
- PA 通过 C 语言开发一款模拟器以及上层的软件(裸机运行时环境, 简易操作系统等)，更关注抽象层次的认识和理解

## 准备工作
进入『一生一芯』工作目录，开 pa1 新分支 `git checkout -b pa1`

初始化 am-kernels: `bash init.sh am-kernels`

### NEMU是什么
NEMU模拟了一个计算机系统，并基于此运行程序

我们可以把计算机看成由若干个硬件部件组成, 这些部件之间相互协助, 完成"运行程序"这件事情. 在NEMU中, 每一个硬件部件都由一个程序相关的数据对象来模拟, 例如变量, 数组, 结构体等; 而对这些部件的操作则通过对相应数据对象的操作来模拟. 例如NEMU中使用数组来模拟内存, 那么对这个数组进行读写则相当于对内存进行读写

### 选择ISA 
ISA是软件和硬件之间的接口——本质就是规范, ISA的存在形式既不是硬件电路, 也不是软件代码, 而是一本规范手册

NEMU的框架代码会把`riscv32`作为默认的ISA, 如果希望选择其它ISA, 需要在NEMU的工程目录下执行 `make menuconfig`, 然后在Base ISA一栏中切换, 然后保存配置并退出菜单, 根据『一生一芯』项目的要求，选择默认的`riscv32`

### 最简单的计算机
由存放程序的存储器，进行运算的CPU等组成. 为了控制CPU进行数据处理，我们可以通过指令来控制; 进而能否让程序来自动控制计算机的执行? 为了实现这个设想, 约定: 当执行完一条指令之后, 就继续执行下一条指令. 有一个特殊的计数器叫`PC(Program Counter)`, 因此，可以简单地认为CPU只做一件事：

```c
while(1){
    从 PC 指示的存储器取出指令;
    执行指令;
    更新 PC;
}
```

我们只要将一段指令序列放置在存储器中, 然后让PC指向第一条指令, 计算机就会自动执行这一段指令序列, 永不停止

### 计算机可以没有寄存器吗, 对编程模型有什么影响
可以，加入寄存器只是提高访问数据的速度; 没有寄存器就直接从内存存取数据，不需要 load/store 操作了

GPT-3.5-Turbo:
```
可能性：理论上，一些极端简化的计算模型可以在没有寄存器的情况下运行，比如图灵机等。这些模型可能通过其他方式来存储和操作数据，但这种情况下的计算机将是极为简化和低效的。
对硬件提供的编程模型的影响：
数据存储和访问：没有寄存器意味着没有快速的内部存储器来存储指令、数据和中间结果。这将导致计算机需要频繁地访问外部存储器，降低了计算机的性能。
指令执行：缺乏寄存器会使得指令的操作数需要从缓慢的内存中读取，导致指令执行速度大幅下降。
编程模型：缺少寄存器将对编程模型产生深远影响，可能需要重新设计指令集架构、编程语言和编程范式，以适应这种新的硬件限制。
```